name: Executar Workflow Externo

on:
  push:
    branches:
      - main  # Ou o branch de sua preferência
    paths-ignore:
      - '.github/workflows/*'  # Ignora alterações em qualquer arquivo dentro da pasta workflows

jobs:
  execute-external-workflow:
    runs-on: ubuntu-latest
    steps:
      - name: Baixar arquivo de workflow do Gits
        run: |
          curl -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" -L -o external-workflow.yml ${{ secrets.GITS_WORKFLOW_URL }}

          
      - name: Passar secret como variável de ambiente      
        run: |
          export MY_SECRET=${{ secrets.MY_SECRET }}
          echo "Secret passado com sucesso, mas não visível nos logs."

          
      - name: Executar workflow baixado
        run: |
          # Aqui você pode rodar o arquivo baixado, por exemplo com `bash`, ou invocar o que for necessário dentro dele.
          # Aqui assumimos que o arquivo YAML baixado está pronto para ser executado como um script bash ou similar
          bash external-workflow.yml
